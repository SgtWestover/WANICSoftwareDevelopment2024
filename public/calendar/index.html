<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar</title>
    <link rel="stylesheet" href="CalendarStyle.css">
    <script>
      // Detect if the environment is local or server
      var isLocal = window.location.hostname === 'localhost' || window.location.hostname.startsWith('192.168');
      // Set the base path accordingly
      var basePath = isLocal ? '' : 'calendar/';

      // Function to set the base path for script and link tags
      function setPath(tagName, attribute) 
      {
        var elements = document.getElementsByTagName(tagName);
        for (var i = 0; i < elements.length; i++) 
        {
          var path = elements[i].getAttribute(attribute);
          if (path) 
          {
            elements[i].setAttribute(attribute, basePath + path);
          }
        }
      }

      // Update the paths when the document is fully loaded
      document.addEventListener('DOMContentLoaded', function() 
      {
        setPath('script', 'src');
        setPath('link', 'href');
      });
    </script>
</head>
<body>

    <header>
        <h1>
          <div id="month-header" onclick="monthHeaderClick()"></div>
          <div id="year-header" onclick="yearHeaderClick()"></div>  
        </h1>
    </header>

     <!-- The sidebar -->
  <div class="sidebar">
    <a class="active" href="#home">Home</a>
    <a href="teams.html">Teams</a>
    <a href="#">TBD</a>
    <a href="#">TBD</a>
  </div>

    <div class="button-container">
        <a id="prev-month">&lt;</a>
        <a id="next-month">&gt;</a>
    </div>

    <button id="signout" style="position: fixed; top: 10px; right: 10px; z-index: 9;" onclick="signout()">Logout</button>
    <button id ="deleteaccount" style = "position:fixed; top: 40px; right: 10px; z-index: 9;" onclick="deleteAccount()">Delete Account</button>
    <!-- Custom Password Modal -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <p>Please enter your password to delete your account</p>
            <input type="password" id="passwordInput" class="password-input">
            <i id="togglePassword" class="fa fa-eye"></i>
            <button id="submitPassword">Submit</button>
            <div id="passwordError" style="color: red;"></div> <!-- Error message element -->
        </div>
    </div>
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <p>Are you sure you want to delete your account?</p>
            <button id="confirmDelete">Yes, delete my account</button>
            <button id="cancelDelete">Cancel</button>
        </div>
    </div>

    <!-- Day Popup box -->
    <div id="popup1" class="overlay">
        <div class="popup">
            <h2 id="popupHeader"></h2>
            <a class="close" href="#" onclick="closeEventForm()">&times;</a> <!--should be general later, dont have time now-->
            <a id="prev-day" class="nav-button">&lt;</a>
            <a id="next-day" class="nav-button">&gt;</a>
            <button id="showEventsSidebar" style="position: absolute; top: 25px; right: 60px;">Show Events</button>
            <div class="popup-content">
                <div id="scheduleBody" class="schedule-body"> </div>
                <div id="lineTimeText" class="lineTimeText"></div>
                <div id="line" class="line"></div>
            </div>
        </div>
    </div>
    <div id="eventPopup" style="display:none; position:fixed; left:50%; top:50%; transform:translate(-50%, -50%); background-color:white; padding:20px; border-radius:5px; box-shadow:0px 0px 10px rgba(0,0,0,0.5); z-index: 35;">
      <h2 id="eventPopupHeader">Create Event</h2>
         <form id="eventForm">
         <label for="eventName">Event Name:</label><br>
         <input type="text" id="eventName" name="eventName" required><br>
         <label for="startTime">Start Time:</label><br>
         <input type="time" id="startTime" name="startTime" step="60" required><br>
         <label for="endTime">End Time:</label><br>
         <input type="time" id="endTime" name="endTime" step="60" required><br>
         <label for="eventDesc">Description:</label><br>
         <textarea id="eventDesc" name="eventDesc" style="resize: none;"></textarea><br>
         <input type="submit" id="submitEventButton" value="Create Event">
         <div id="errorMessage" style="color: red; display: none;"></div> <!-- Error message element -->
         <button type="button" onclick="closeEventForm()">Cancel</button>
     </form>
 </div>
    <!-- Events Sidebar -->
  <div id="eventsSidebar" class="sidebar-overlay">
    <div class="sidebar-content">
        <span id="closeSidebar" class="close-sidebar">&times;</span>
        <div id="eventsList" class="events-list">
            <!-- Events will be dynamically added here -->
        </div>
    </div>
  </div>
  <!-- Month Dropdown -->
  <div class="month-dropdown">
    <button onclick="monthHeaderClick()" class="month-dropbutton">Month</button>
    <div id="month-dropdown" class="month-dropdown-content">
      <div onclick="setmonth(1)">January</div>
      <div onclick="setmonth(2)">February</div>
      <div onclick="setmonth(3)">March</div>
      <div onclick="setmonth(4)">April</div>
      <div onclick="setmonth(5)">May</div>
      <div onclick="setmonth(6)">June</div>
      <div onclick="setmonth(7)">July</div>
      <div onclick="setmonth(8)">Augest</div>
      <div onclick="setmonth(9)">September</div>
      <div onclick="setmonth(10)">October</div>
      <div onclick="setmonth(11)">November</div>
      <div onclick="setmonth(12)">December</div>
    </div>
  </div>
  <!-- Year Dropdown -->

  <div id="pageOverlay" class="page-overlay" style="display:none;"></div>
  <!-- Page content -->
  <div class="content">
    <table id="calendar">
        <thead>
            <tr>
                <th>Sun</th>
                <th>Mon</th>
                <th>Tue</th>
                <th>Wed</th>
                <th>Thu</th>
                <th>Fri</th>
                <th>Sat</th>
            </tr>
        </thead>
        <tbody id="calendar-body"> <!-- created using javascript -->
        </tbody>
    </table>
  </div>
    <script src="/scripts/UserData.js"></script>
    <script src="CalendarFormat.js"></script>
    <script src="DayScheduleFormat.js"></script>
    <script src="Account.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"></body>
</html>
